<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lab Workflow &mdash; Formulas and Vehicles  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dynamic Reconfigure" href="dynamic_reconfigure.html" />
    <link rel="prev" title="Simulation" href="simulation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Formulas and Vehicles
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Class Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the_robot.html">The Robot</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ros.html">ROS</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lab Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checklist">Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="#at-the-lab">At the Lab</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dynamic_reconfigure.html">Dynamic Reconfigure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">ROS Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignment1.html">Assignment 1</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Formulas and Vehicles</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
      <li>Lab Workflow</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/HippoCampusRobotics/fav_docs/blob/master/tutorials/lab_workflow.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="lab-workflow">
<h1>Lab Workflow<a class="headerlink" href="#lab-workflow" title="Permalink to this headline"></a></h1>
<p>Time for experiments!</p>
<a class="reference internal image-reference" href="../_images/lab_work1.jpg"><img alt="../_images/lab_work1.jpg" class="align-center" src="../_images/lab_work1.jpg" style="width: 80%;" /></a>
<div class="section" id="checklist">
<h2>Checklist<a class="headerlink" href="#checklist" title="Permalink to this headline"></a></h2>
<p>The following steps can be prepared at home before coming to the lab.</p>
<ol class="arabic">
<li><p>Set the <code class="code docutils literal notranslate"><span class="pre">ROS_MASTER_URI</span></code> and <code class="code docutils literal notranslate"><span class="pre">ROS_HOSTNAME</span></code> environment variables in <code class="file docutils literal notranslate"><span class="pre">~/.bashrc</span></code>. You can have both configurations, for your simulation setup and your experiment setup and comment out the one you are not using with <code class="code docutils literal notranslate"><span class="pre">#</span></code>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-U2ltdWxhdGlvbg==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U2ltdWxhdGlvbg==" name="U2ltdWxhdGlvbg==" role="tab" tabindex="0">Simulation</button><button aria-controls="panel-0-TGFi" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-TGFi" name="TGFi" role="tab" tabindex="-1">Lab</button></div><div aria-labelledby="tab-0-U2ltdWxhdGlvbg==" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-U2ltdWxhdGlvbg==" name="U2ltdWxhdGlvbg==" role="tabpanel" tabindex="0"><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">ROS_HOSTNAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>hostname --short<span class="k">)</span><span class="s2">.local&quot;</span>

<span class="c1"># Your simulation/home setup</span>
<span class="nb">export</span> <span class="nv">ROS_MASTER_URI</span><span class="o">=</span><span class="s2">&quot;http://</span><span class="k">$(</span>hostname --short<span class="k">)</span><span class="s2">.local:11311&quot;</span>

<span class="c1"># Your realworld/lab setup</span>
<span class="c1">#ROS_MASTER_URI=&quot;http://hippo-celsius.local:11311&quot;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-TGFi" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-TGFi" name="TGFi" role="tabpanel" tabindex="0"><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">ROS_HOSTNAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>hostname --short<span class="k">)</span><span class="s2">.local&quot;</span>

<span class="c1"># Your simulation/home setup</span>
<span class="c1">#export ROS_MASTER_URI=&quot;http://$(hostname --short).local:11311&quot;</span>

<span class="c1"># Your realworld/lab setup</span>
<span class="nb">export</span> <span class="nv">ROS_MASTER_URI</span><span class="o">=</span><span class="s2">&quot;http://hippo-celsius.local:11311&quot;</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As always, run <code class="code docutils literal notranslate"><span class="pre">source</span> <span class="pre">~/.bashrc</span></code> to apply these changes.</p>
</div>
</li>
<li><p>Make sure you do not <strong>arm</strong> the vehicle. In the lab we will arm the vehicle manually for you. If your <code class="file docutils literal notranslate"><span class="pre">bluerov_sim</span></code> is up-to-date, there is a dedicated <code class="file docutils literal notranslate"><span class="pre">auto_arm_node</span></code> in <code class="file docutils literal notranslate"><span class="pre">~/fav/catkin_ws/src/bluerov_sim/nodes</span></code>. If that is the case, you do not need to worry about anything as the vehicle only gets auto-armed in the simulation. Otherwise please update the <code class="file docutils literal notranslate"><span class="pre">bluerov_sim</span></code> package.</p></li>
<li><p>Adapt your launch setup so that gazebo will not be started. We do not need gazebo since we are working with the real robot. Either change your launchfile you used for the simulation or (<strong>recommended</strong>) create a modified copy. For example, you could create a <code class="code docutils literal notranslate"><span class="pre">keyboard_control_sim.launch</span></code> and a <code class="code docutils literal notranslate"><span class="pre">keyboard_control_lab.launch</span></code> in your depth controller package. The highlighted lines are removed for the lab setup.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-U2ltdWxhdGlvbg==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U2ltdWxhdGlvbg==" name="U2ltdWxhdGlvbg==" role="tab" tabindex="0">Simulation</button><button aria-controls="panel-1-TGFi" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-TGFi" name="TGFi" role="tab" tabindex="-1">Lab</button></div><div aria-labelledby="tab-1-U2ltdWxhdGlvbg==" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-U2ltdWxhdGlvbg==" name="U2ltdWxhdGlvbg==" role="tabpanel" tabindex="0"><div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;launch&gt;</span>
   <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;vehicle_name&quot;</span> <span class="na">default=</span><span class="s">&quot;bluerov&quot;</span> <span class="nt">/&gt;</span>

<span class="hll">   <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find bluerov_sim)/launch/gazebo_base.launch&quot;</span> <span class="nt">/&gt;</span>
</span>   <span class="nt">&lt;group</span> <span class="na">ns=</span><span class="s">&quot;$(arg vehicle_name)&quot;</span><span class="nt">&gt;</span>

<span class="hll">      <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find bluerov_sim)/launch/spawn_vehicle.launch&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;z&quot;</span> <span class="na">value=</span><span class="s">&quot;-0.2&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">      <span class="nt">&lt;/include&gt;</span>
</span>
      <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;keyboard&quot;</span> <span class="na">pkg=</span><span class="s">&quot;bluerov_sim&quot;</span> <span class="na">type=</span><span class="s">&quot;keyboard_control.py&quot;</span> <span class="na">output=</span><span class="s">&quot;screen&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;mixer&quot;</span> <span class="na">pkg=</span><span class="s">&quot;bluerov_sim&quot;</span> <span class="na">type=</span><span class="s">&quot;mixer.py&quot;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/group&gt;</span>

<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-TGFi" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-TGFi" name="TGFi" role="tabpanel" tabindex="0"><div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;launch&gt;</span>
   <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;vehicle_name&quot;</span> <span class="na">default=</span><span class="s">&quot;bluerov&quot;</span> <span class="nt">/&gt;</span>

   <span class="nt">&lt;group</span> <span class="na">ns=</span><span class="s">&quot;$(arg vehicle_name)&quot;</span><span class="nt">&gt;</span>

      <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;keyboard&quot;</span> <span class="na">pkg=</span><span class="s">&quot;bluerov_sim&quot;</span> <span class="na">type=</span><span class="s">&quot;keyboard_control.py&quot;</span> <span class="na">output=</span><span class="s">&quot;screen&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;mixer&quot;</span> <span class="na">pkg=</span><span class="s">&quot;bluerov_sim&quot;</span> <span class="na">type=</span><span class="s">&quot;mixer.py&quot;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/group&gt;</span>

<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
</div></div>
</li>
<li><p>It’s best if one of you brings a <strong>fully prepared software setup on your own laptop</strong>. The real experiment will take less computing power since you are not running the simulation environment. If you cannot do this, let us know <strong>in time</strong> and we will prepare a laptop for you to use.</p></li>
<li><p>The setup can include a prepared settings file for <code class="code docutils literal notranslate"><span class="pre">rqt_multiplot</span></code>.</p></li>
</ol>
</div>
<div class="section" id="at-the-lab">
<h2>At the Lab<a class="headerlink" href="#at-the-lab" title="Permalink to this headline"></a></h2>
<ol class="arabic">
<li><p>The first time you’re at the lab, we will give you an overview of the robot and its sensors. We will take care of connecting the battery and starting all ROS nodes and software running on the vehicle. Additionally, we will also arm the vehicle for you (once it’s in the water).</p></li>
<li><p>Before lifting the BlueROV into the water, we will do a vaccuum test together. After the test, <strong>do not forget to close the vents!</strong></p>
<a class="reference internal image-reference" href="../_images/vaccuum_test.gif"><img alt="../_images/vaccuum_test.gif" src="../_images/vaccuum_test.gif" style="width: 40%;" /></a>
<a class="reference internal image-reference" href="../_images/vent_plugs.jpg"><img alt="../_images/vent_plugs.jpg" src="../_images/vent_plugs.jpg" style="width: 40%;" /></a>
<p>Vaccuum test and vent caps saying “OK”.</p>
</li>
<li><p>To test the network setup, open two terminals to publish and echo ROS topics.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-cHVibGlzaA==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-cHVibGlzaA==" name="cHVibGlzaA==" role="tab" tabindex="0">publish</button><button aria-controls="panel-2-ZWNobw==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-ZWNobw==" name="ZWNobw==" role="tab" tabindex="-1">echo</button></div><div aria-labelledby="tab-2-cHVibGlzaA==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-cHVibGlzaA==" name="cHVibGlzaA==" role="tabpanel" tabindex="0"><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rostopic pub -r <span class="m">1</span> /test std_msgs/String <span class="s2">&quot;hello from laptop&quot;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-ZWNobw==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-ZWNobw==" name="ZWNobw==" role="tabpanel" tabindex="0"><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rostopic <span class="nb">echo</span> /test
</pre></div>
</div>
</div></div>
<p>We will prepare an equivalent setup on our machine. If you receive our messages saying “hello from celsius” and we receive messages saying “hello from laptop”, everything is fine.</p>
</li>
<li><p>We have a big TV screen at the lab. You can use it (we have HDMI and DisplayPort) for plotting data etc. so that everyone can see.</p></li>
<li><p>If you record data via <code class="code docutils literal notranslate"><span class="pre">rosbag</span></code>, do not include camera images (or if you need camera data, include just one topic). Camera images can overload the network. You can exclude topics matching regular expressions with <code class="code docutils literal notranslate"><span class="pre">-x</span></code>.
For example</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rosbag record -a -x <span class="s2">&quot;(.*)camera(.*)&quot;</span>
</pre></div>
</div>
<p>should exclude all topics containing <code class="file docutils literal notranslate"><span class="pre">camera</span></code>.</p>
</li>
<li><p>And after all, if nothing is working, a few debugging tips:</p>
<ul class="simple">
<li><p>check the node graph to see if everything is connected (in the correct way)</p></li>
<li><p>check the topic monitor (Is the data plausible?)</p></li>
<li><p>check the debug messages published (of course you have prepared some :) )</p></li>
<li><p>ask us to check our setup (we make mistakes, too)</p></li>
</ul>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Feel free to ask questions at any time!</strong>
Let us know if you need any equipment (measuring tape, scale, weights, stick, …). If you’re looking for something we might not have at hand immediately, please ask beforehand.</p>
</div>
<a class="reference internal image-reference" href="../_images/lab_work2.jpg"><img alt="../_images/lab_work2.jpg" class="align-center" src="../_images/lab_work2.jpg" style="width: 80%;" /></a>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="simulation.html" class="btn btn-neutral float-left" title="Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dynamic_reconfigure.html" class="btn btn-neutral float-right" title="Dynamic Reconfigure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Thies Lennart Alff, Nathalie Bauschmann, Daniel Dücker.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>