<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
    <link href="../_static/bluerov.svg" rel="icon" type="image/svg+xml">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ROS Package &mdash; Formulas and Vehicles  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/asciinema-player_2.6.1.css" type="text/css" />
      <link rel="stylesheet" href="../_static/asciinema-custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/asciinema-player_2.6.1.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ROS Launch Setup" href="ros_launch_setup.html" />
    <link rel="prev" title="Tutorials" href="../00_main_toc/tutorials.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Formulas and Vehicles
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/overview.html">Class Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/installation.html">Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/the_robot.html">The Robot</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../00_main_toc/tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ROS Package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-package">Create A Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#write-a-node">Write A Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-a-node">Run A Node</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ros_launch_setup.html">ROS Launch Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="ros_names_and_namespaces.html">Names and Namespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="rqt_multiplot.html">RQt Multiplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_workflow.html">Lab Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="recording_rosbags.html">Recording Data Using Bag Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamic_reconfigure.html">Dynamic Reconfigure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/depth_estimator_example.html">Depth-Estimator Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/resources.html">ROS Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/assignment_depth_control.html">Assignment 1 - Depth Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/assignment_loc_and_control.html">Assignment 2 - Localization and Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_main_toc/final_project.html">Final Project</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Formulas and Vehicles</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../00_main_toc/tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">ROS Package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/HippoCampusRobotics/fav_docs/blob/main/tutorials/ros_package.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ros-package">
<h1>ROS Package<a class="headerlink" href="#ros-package" title="Permalink to this heading"></a></h1>
<p>In this section you will:</p>
<ul class="simple">
<li><p>create a new ros package</p></li>
<li><p>write a node in <code class="code docutils literal notranslate"><span class="pre">python</span></code></p></li>
<li><p>run a node via <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span></code></p></li>
<li><p>use the tools <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span> <span class="pre">info</span></code> and <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">topic</span> <span class="pre">echo</span></code></p></li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The following tutorial <strong>is not meant as a step-by-step solution for the first assignment.</strong> These are just <strong>toy examples</strong> to demonstrate how to use ROS and interact with the simulated BlueROV <em>in an easy to follow manner</em>. Therefore, we do not claim that these code snippets are complete and we use some funny names at times. Please do <strong>not</strong> copy-paste them.</p>
</div>
<section id="create-a-package">
<h2>Create A Package<a class="headerlink" href="#create-a-package" title="Permalink to this heading"></a></h2>
<p>If you have completed all the installation instructions in <a class="reference internal" href="../installation/install_ros.html#install-ros"><span class="std std-ref">Install ROS</span></a>, you have already created a Catkin workspace at <code class="file docutils literal notranslate"><span class="pre">~/fav/catkin_ws</span></code>. The workspace contains several directories:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>~/fav/ros2
├── build
├── install
├── log
└── src
</pre></div>
</div>
<p>Probably the only one you will be working with is the <code class="file docutils literal notranslate"><span class="pre">src</span></code> directory. This is the place where the so called <em>packages</em> are.</p>
<p>For our code directories to be recognized as packages, two files are required:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">package.xml</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p></li>
</ul>
<p>Otherwise a package is nothing but a normal directory containing arbitrary files and subdirectories.
Packages can also be in arbitrary subdirectories, since the build system will look for directories containing a <code class="file docutils literal notranslate"><span class="pre">package.xml</span></code> recursively to identify packages.
An example for this is the <code class="file docutils literal notranslate"><span class="pre">hippo_core</span></code> repository you cloned during the setup instructions.
The <code class="file docutils literal notranslate"><span class="pre">hippo_core</span></code> directory itself is not a package, but contains packages as subdirectories like <code class="file docutils literal notranslate"><span class="pre">hippo_common</span></code> or <code class="file docutils literal notranslate"><span class="pre">hippo_msgs</span></code>.</p>
<p>For this guide it is not necessary to go into details too much.
But if you like to know more about packages, you can read the article about packages in the <a class="reference external" href="https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html">ROS Docs</a>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>In ROS2 there is the option to create native Python packages. For this class, we stick to the CMake way of organizing packages. Even if we write pure Python packages. So in this regard our instructions differ from the official documentation.</p>
</div>
<p>Go to the <code class="file docutils literal notranslate"><span class="pre">src</span></code> directory</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/fav/ros2/src
</pre></div>
</div>
<p>and create the package directory</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>awesome_package
</pre></div>
</div>
<p>Remember, we need at least <code class="file docutils literal notranslate"><span class="pre">package.xml</span></code> and <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.
Almost minimal examples are presented in the following.
Take a look at the highlighted lines.
Replace the project’s name with your own package name.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">CMakeLists.txt</span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.5</span><span class="p">)</span>
<span class="hll"><span class="linenos"> 2</span><span class="nb">project</span><span class="p">(</span><span class="s">awesome_package</span><span class="p">)</span>
</span><span class="linenos"> 3</span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake_python</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="nb">find_package</span><span class="p">(</span><span class="s">rclpy</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="nb">install</span><span class="p">(</span><span class="s">PROGRAMS</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span>
<span class="linenos"> 9</span><span class="p">)</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="nb">ament_package</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">package.xml</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="linenos"> 2</span><span class="cp">&lt;?xml-model href=&quot;http://download.ros.org/schema/package_format3.xsd&quot; schematypens=&quot;http://www.w3.org/2001/XMLSchema&quot;?&gt;</span>
<span class="linenos"> 3</span><span class="nt">&lt;package</span><span class="w"> </span><span class="na">format=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;</span>
<span class="hll"><span class="linenos"> 4</span><span class="w">  </span><span class="nt">&lt;name&gt;</span>awesome_package<span class="nt">&lt;/name&gt;</span>
</span><span class="linenos"> 5</span><span class="w">  </span><span class="nt">&lt;version&gt;</span>0.0.0<span class="nt">&lt;/version&gt;</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="nt">&lt;description&gt;</span>Our<span class="w"> </span>super<span class="w"> </span>awesome<span class="w"> </span>package<span class="nt">&lt;/description&gt;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="nt">&lt;maintainer</span><span class="w"> </span><span class="na">email=</span><span class="s">&quot;someones.mail.address@tuhh.de&quot;</span><span class="nt">&gt;</span>Someones<span class="w"> </span>name<span class="nt">&lt;/maintainer&gt;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="w">  </span><span class="cm">&lt;!-- One license tag required, multiple allowed, one license per tag --&gt;</span>
<span class="linenos">11</span><span class="w">  </span><span class="cm">&lt;!-- Commonly used license strings: --&gt;</span>
<span class="linenos">12</span><span class="w">  </span><span class="cm">&lt;!--   BSD, MIT, Boost Software License, GPLv2, GPLv3, LGPLv2.1, LGPLv3 --&gt;</span>
<span class="linenos">13</span><span class="w">  </span><span class="nt">&lt;license&gt;</span>GPLv2<span class="nt">&lt;/license&gt;</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">  </span><span class="nt">&lt;url</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;website&quot;</span><span class="nt">&gt;</span>hippocampusrobotics.github.io/docs<span class="nt">&lt;/url&gt;</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">  </span><span class="nt">&lt;author</span><span class="w"> </span><span class="na">email=</span><span class="s">&quot;someones.mail@tuhh.de&quot;</span><span class="nt">&gt;</span>Someones<span class="w"> </span>name<span class="nt">&lt;/author&gt;</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="w">  </span><span class="nt">&lt;buildtool_depend&gt;</span>ament_cmake<span class="nt">&lt;/buildtool_depend&gt;</span>
<span class="linenos">20</span><span class="w">  </span><span class="nt">&lt;buildtool_depend&gt;</span>ament_cmake_python<span class="nt">&lt;/buildtool_depend&gt;</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="w">  </span><span class="nt">&lt;depend&gt;</span>rclpy<span class="nt">&lt;/depend&gt;</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="w">  </span><span class="cm">&lt;!-- The export tag contains other, unspecified, tags --&gt;</span>
<span class="linenos">25</span><span class="w">  </span><span class="nt">&lt;export&gt;</span>
<span class="linenos">26</span><span class="w">    </span><span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
<span class="linenos">27</span><span class="w">  </span><span class="nt">&lt;/export&gt;</span>
<span class="linenos">28</span><span class="nt">&lt;/package&gt;</span>
</pre></div>
</div>
</div>
<p>That’s it. You have just created your first catkin package.
Your package structure should look similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>~/fav/ros2/src
└── awesome_package
    ├── CMakeLists.txt
    └── package.xml
</pre></div>
</div>
<p>We can now build our workspace</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>build_ros
</pre></div>
</div>
<p>and source the newly created package.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>.<span class="w"> </span>~/.bashrc
</pre></div>
</div>
<p>This only needs to be done once a new package is created.
Nothing bad happens if we are a bit overly cautios regarding sourcing our <code class="file docutils literal notranslate"><span class="pre">.bashrc</span></code>.
But it does nothing good either.
So we might want to save it up for the cases where it is actually required.</p>
<p>If the commands mentioned above completed without errors, we can check if our newly created is detected correctly.
The following command should give as the installation path of our package.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>pkg<span class="w"> </span>prefix<span class="w"> </span>awesome_package
</pre></div>
</div>
<p>In case things did not work out as expected, we might get <code class="code docutils literal notranslate"><span class="pre">Package</span> <span class="pre">not</span> <span class="pre">found</span></code> as response.
This indicates that we (most likely) messed something up while following the instructions above.
Double check everything and if this does not fix the problem ask your favorite research associate.</p>
</section>
<section id="write-a-node">
<h2>Write A Node<a class="headerlink" href="#write-a-node" title="Permalink to this heading"></a></h2>
<p>In general, you have the choice to write nodes either in Python or in C++.
For the sake of simplicity we recommend Python.
If you haven’t already worked with one of these languages, in some regards Python might feel similiar to Matlab.</p>
<p>Before we can write a node, we create a <code class="file docutils literal notranslate"><span class="pre">nodes/</span></code> directory to keep things neat and clean.
It is not strictly required (ROS will find your node as long as it is in your package, no matter in which subdirectory it is), but it complies with conventions.</p>
<p>Right click <code class="file docutils literal notranslate"><span class="pre">awesome_package</span></code> and choose <strong>New Folder</strong> and name it <code class="file docutils literal notranslate"><span class="pre">nodes</span></code>. Right click <code class="file docutils literal notranslate"><span class="pre">nodes</span></code> and choose <strong>New File</strong>. Name it <code class="file docutils literal notranslate"><span class="pre">setpoint_publisher.py</span></code>. It should open automatically.</p>
<img alt="../_images/vscode_create_node.gif" src="../_images/vscode_create_node.gif" />
<p>We have to make the Python file executable.
To do so, enter the following command in your terminal (for example the integrated one in VS Code):</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>chmod<span class="w"> </span>+x<span class="w"> </span>~/fav/ros2/src/awesome_package/nodes/setpoint_publisher.py
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Just in case the integrated terminal is not open: You can open it with <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">`</kbd>.</p>
</div>
<p>The general syntax is <code class="code docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span> <span class="pre">PATH_TO_THE_FILE</span></code>.</p>
<p>If you feel more comfortable with the graphical interface, you can also set the executable flag in the file browser by right clicking it and open its properties:</p>
<img alt="../_images/executable.gif" src="../_images/executable.gif" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each time you create a new node, make sure you have made it executable.</p>
</div>
<p>The first line of your node needs to be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="ch">#!/usr/bin/env python3</span>
</pre></div>
</div>
<p>so your system knows your file should be executed as a Python file.</p>
<p>Your first node could look like:</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Replace this snippet with correct ros2 code</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#!/usr/bin/env python3</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>  <span class="c1"># import the node class from the ros client library</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">math</span>  <span class="c1"># needed to use the trigonometric functions sin and cos</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">hippo_msgs.msg</span> <span class="kn">import</span> <span class="n">ActuatorControls</span>  <span class="c1"># this is a ROS message class</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="k">class</span> <span class="nc">MyFirstNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
<span class="linenos"> 8</span>   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 9</span>      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_name</span><span class="o">=</span><span class="s1">&#39;setpoint_publisher&#39;</span><span class="p">)</span>
<span class="linenos">10</span>      <span class="bp">self</span><span class="o">.</span><span class="n">setpoint_pub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span><span class="n">ActuatorControl</span><span class="p">,</span> <span class="s1">&#39;thruster_controls&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span>   <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">13</span>      <span class="n">rate</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Rate</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span>      <span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">():</span>
<span class="linenos">16</span>            <span class="n">msg</span> <span class="o">=</span> <span class="n">ThrusterSetpoint</span><span class="p">()</span>
<span class="linenos">17</span>            <span class="n">msg</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">stamp</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="linenos">18</span>            <span class="c1"># since the bluerov has 8 thrusters, the setpoint list holds 8 values</span>
<span class="linenos">19</span>            <span class="n">t</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">get_time</span><span class="p">()</span>
<span class="linenos">20</span>            <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">21</span>            <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">22</span>            <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">23</span>            <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">24</span>            <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">25</span>            <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">26</span>            <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">27</span>            <span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">28</span>
<span class="linenos">29</span>            <span class="bp">self</span><span class="o">.</span><span class="n">setpoint_pub</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="linenos">30</span>
<span class="linenos">31</span>            <span class="n">rate</span><span class="o">.</span><span class="n">sleep</span><span class="p">()</span>
<span class="linenos">32</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="linenos">35</span>   <span class="n">node</span> <span class="o">=</span> <span class="n">MyFirstNode</span><span class="p">()</span>
<span class="linenos">36</span>   <span class="n">node</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="linenos">37</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">40</span>   <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="run-a-node">
<h2>Run A Node<a class="headerlink" href="#run-a-node" title="Permalink to this heading"></a></h2>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>For each node we have to modify the <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> of the corresponding package. Add the node’s path relative to the package’s root to the <code class="code docutils literal notranslate"><span class="pre">install()</span></code> call.</p>
</div>
<p>For our first node we add the highlighted line to the <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">install</span><span class="p">(</span><span class="s">PROGRAMS</span>
<span class="hll"><span class="w">  </span><span class="s">nodes/setpoint_publisher.py</span>
</span><span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Every</strong> time you modify the <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> rebuild your workspace with <code class="code docutils literal notranslate"><span class="pre">catkin</span> <span class="pre">build</span></code> and to be super save you might also want to resource your workspace setup with <code class="code docutils literal notranslate"><span class="pre">.</span> <span class="pre">~/.bashrc</span></code>.</p>
<p>If you want to run a Python program, normally you would use a command like <code class="code docutils literal notranslate"><span class="pre">python3</span> <span class="pre">/path/to/your/file/python_file.py</span></code>.
This would work for our node, too.
But instead of running our node by entering <code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">~/fav/ros2/src/awesome_package/nodes/setpoint_publisher.py</span></code>, where we have to explicitly tell Python where it can find our file <code class="file docutils literal notranslate"><span class="pre">setpoint_publisher.py</span></code>, we can use <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span></code>. One of the advantages of <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span></code> is that we do not have to know where the program/node is that we want to run.
The command finds the source file on its own.</p>
<p>The general usage of the <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span></code> command is <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span> <span class="pre">&lt;package_name&gt;</span> <span class="pre">&lt;executable_name&gt;</span></code>. So for our <code class="file docutils literal notranslate"><span class="pre">awesome_package</span></code> and its <code class="file docutils literal notranslate"><span class="pre">setpoint_publisher.py</span></code> it would be:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>awesome_package<span class="w"> </span>setpoint_publisher.py
</pre></div>
</div>
<p>If you try to do so right now, you will likely get an error message <code class="code docutils literal notranslate"><span class="pre">No</span> <span class="pre">executable</span> <span class="pre">found</span></code>.</p>
<p>We created a package, but we haven’t built our workspace since we modified <code class="code docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> (remember, that we are supposed to rebuild our workspace each time we modify this file?).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>build_ros
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Every time we create a new package, or create a new node in an existing package, we need to build our Catkin workspace with <code class="code docutils literal notranslate"><span class="pre">build_ros</span></code> and apply the updated package paths with <code class="code docutils literal notranslate"><span class="pre">.</span> <span class="pre">~/.bashrc</span></code>.</p>
</div>
<p>Now, we should be ready to finally run our code</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>awesome_package<span class="w"> </span>setpoint_publisher.py
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can use <kbd class="kbd docutils literal notranslate">Tab</kbd> to use the shell’s ability to auto-complete your commands. If the auto-completion is unambigous, a single hit will suffice. If there is more than one auto-complete option, hit <kbd class="kbd docutils literal notranslate">Tab</kbd> twice to show the different options.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Just to remind you: you stop running programs in a terminal by the shortcut <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">C</kbd>.</p>
</div>
<p>In the node’s source code you can see that the sent thruster setpoints are <code class="code docutils literal notranslate"><span class="pre">sin</span></code> and <code class="code docutils literal notranslate"><span class="pre">cos</span></code> signals.</p>
<p>We have started the <code class="code docutils literal notranslate"><span class="pre">setpoint_publisher.py</span></code> node but since it just publishes ROS messages, we can’t see any output in the terminals.
We can use command line tools <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span></code> and <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">topic</span></code> to get some insights on what is going on in the background hidden from our curious eyes.
With <code class="code docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span> <span class="pre">info</span> <span class="pre">/name/of/our/node</span></code> we can get various information on our node. For example what publications and what subscriptions it has.
Or in other words: what are the topics the node wants to receive data on and what are the topics it ouputs data on.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Again, we can use <kbd class="kbd docutils literal notranslate">Tab</kbd> to auto-complete the node name after we have started writing the first few characters.
Start using this feature if you haven’t already!</p>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Continue to change stuff for ROS2 from here on!</p>
</div>
<p>We see the publications <code class="file docutils literal notranslate"><span class="pre">/rosout</span></code> and <code class="file docutils literal notranslate"><span class="pre">/thruster_setpoint</span></code>. Every node publishes to <code class="file docutils literal notranslate"><span class="pre">/rosout</span></code> for logging, so we are not interested in it for now. But the node publishes <code class="file docutils literal notranslate"><span class="pre">/thruster_setpoint</span></code> with the message type <code class="file docutils literal notranslate"><span class="pre">fav_msgs/ThrusterSetpoint</span></code> because we told it to do so. Rember these lines from the <code class="file docutils literal notranslate"><span class="pre">setpoint_publisher.py</span></code>?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 9</span>   <span class="n">rospy</span><span class="o">.</span><span class="n">init_node</span><span class="p">(</span><span class="s2">&quot;setpoint_publisher&quot;</span><span class="p">)</span>
<span class="linenos">10</span>   <span class="bp">self</span><span class="o">.</span><span class="n">setpoint_pub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Publisher</span><span class="p">(</span><span class="s2">&quot;thruster_setpoint&quot;</span><span class="p">,</span>
<span class="linenos">11</span>                                       <span class="n">ThrusterSetpoint</span><span class="p">,</span>
<span class="linenos">12</span>                                       <span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Line 9 tells ROS to create a node with the name <code class="code docutils literal notranslate"><span class="pre">&quot;setpoint_publisher&quot;</span></code> and in line 10 we create a publisher with the topic name <code class="code docutils literal notranslate"><span class="pre">&quot;thruster_setpoint&quot;</span></code> and the message type <code class="code docutils literal notranslate"><span class="pre">ThrusterSetpoint</span></code>.</p>
<p>To see what messages the node is actually publishing, we use <code class="code docutils literal notranslate"><span class="pre">rostopic</span> <span class="pre">echo</span> <span class="pre">/the/topic/name/to/echo</span></code>.</p>
<asciinema-player speed="2" start-at="1" idle-time-limit="1" poster="npt:0:01"  src="data:application/json;base64,eyJ2ZXJzaW9uIjogMiwgIndpZHRoIjogODAsICJoZWlnaHQiOiAyNSwgInRpbWVzdGFtcCI6IDE2NjYxNzU4NDIsICJlbnYiOiB7IlNIRUxMIjogIi9iaW4vYmFzaCIsICJURVJNIjogInh0ZXJtIn19ClswLjE1NjcyOSwgIm8iLCAiXHUwMDFiXTA7fi9mYXYvY2F0a2luX3dzXHUwMDA3Il0KWzAuMTU3NDg1LCAibyIsICJcclxuIl0KWzAuMTU3NTMyLCAibyIsICJcdTAwMWJdMjt2c2NvZGVAYXJjaFZlcm1lZXI6fi9mYXYvY2F0a2luX3dzXHUwMDA3XHUwMDFiXTE7fi9mYXYvY2F0a2luX3dzXHUwMDA3Il0KWzAuMTU3NjIyLCAibyIsICJcdTAwMWJbMG1cdTAwMWJbMjdtXHUwMDFiWzI0bVx1MDAxYltKXHUwMDFiWzM0bX4vZmF2L2NhdGtpbl93c1x1MDAxYlszOW1cclxuXHJcdTAwMWJbMzVt4p2vXHUwMDFiWzM5bSBcdTAwMWJbSyJdClswLjE1NzcxOCwgIm8iLCAiXHUwMDFiWz8xaFx1MDAxYj0iXQpbMC4xNTc3MzgsICJvIiwgIlx1MDAxYls/MjAwNGgiXQpbMi4wNzQ1NCwgIm8iLCAiciJdClsyLjM0MTAzOCwgIm8iLCAiXGJybyJdClsyLjU4MDk0MSwgIm8iLCAicyJdClsyLjc4ODY0MywgIm8iLCAidCJdClsyLjkwNDExMywgIm8iLCAibyJdClsyLjk4ODUxNCwgIm8iLCAicCJdClszLjI3ODA0OCwgIm8iLCAiaSJdClszLjQzNjA2NCwgIm8iLCAiYyJdClszLjYyNTU1MywgIm8iLCAiICJdClszLjgyNzM0NywgIm8iLCAiZSJdCls0LjQyNTA5NCwgIm8iLCAiYyJdCls0LjgxOTE0MSwgIm8iLCAiaCJdCls1LjAyMDExOSwgIm8iLCAibyJdCls1LjEyMTU0NCwgIm8iLCAiICJdCls1LjUwOTA1LCAibyIsICIvIl0KWzUuNzczMzU4LCAibyIsICJ0Il0KWzUuODk5MTgyLCAibyIsICJoIl0KWzYuMDEwMDI2LCAibyIsICJ1Il0KWzYuNDg3MjE4LCAibyIsICJcYiBcYiJdCls2LjU3Nzc0OSwgIm8iLCAiciJdCls3LjEwMzUzNCwgIm8iLCAidXN0ZXJfc2V0cG9pbnRcdTAwMWJbMW0gXHUwMDFiWzBtIl0KWzguNzAwNDc1LCAibyIsICJcYlx1MDAxYlswbSAtIl0KWzkuMDgxMTk3LCAibyIsICJuIl0KWzkuMTcwMTA0LCAibyIsICIgIl0KWzkuNjAwMDgsICJvIiwgIjEiXQpbMTAuMTY2MDIxLCAibyIsICJcdTAwMWJbPzFsXHUwMDFiPiJdClsxMC4xNjYxNzcsICJvIiwgIlx1MDAxYls/MjAwNGxcclxyXG4iXQpbMTAuMTY2NTgsICJvIiwgIlx1MDAxYl0wO2NhdGtpbl93czogcm9zdG9waWMgZWNobyAvdGhydXN0ZXJfc2V0cG9pbnQgLW4gMVx1MDAwNyJdClsxMC4xNjY3ODksICJvIiwgIlx1MDAxYl0yO3Jvc3RvcGljIGVjaG8gL3RocnVzdGVyX3NldHBvaW50IC1uIDFcdTAwMDdcdTAwMWJdMTtyb3N0b3BpY1x1MDAwNyJdClsxMC40Njc5MjIsICJvIiwgImhlYWRlcjogXHJcbiAgc2VxOiA0MTQ1M1xyXG4gIHN0YW1wOiBcclxuICAgIHNlY3M6IDE2NjYxNzU4NTNcclxuICAgIG5zZWNzOiAxMDcyMjY2MTBcclxuICBmcmFtZV9pZDogJydcclxuZGF0YTogWzAuMDk4OTUxOTMwMTA4OTIxNSwgLTAuMDk4OTUxOTMwMTA4OTIxNSwgMC4xNzM4MDU5NzA5MjA3OTE3OCwgLTAuMTczODA1OTcwOTIwNzkxNzgsIDAuMTk3OTAzODYwMjE3ODQzLCAtMC4xOTc5MDM4NjAyMTc4NDMsIDAuMzQ3NjExOTQxODQxNTgzNTYsIC0wLjM0NzYxMTk0MTg0MTU4MzU2XVxyXG4tLS1cclxuIl0KWzExLjE4NDcxNSwgIm8iLCAiXHUwMDFiXTA7fi9mYXYvY2F0a2luX3dzXHUwMDA3Il0KWzExLjE4NTE1NCwgIm8iLCAiXHJcbiJdClsxMS4xODUyMDUsICJvIiwgIlx1MDAxYl0yO3ZzY29kZUBhcmNoVmVybWVlcjp+L2Zhdi9jYXRraW5fd3NcdTAwMDdcdTAwMWJdMTt+L2Zhdi9jYXRraW5fd3NcdTAwMDciXQpbMTEuMTg1MjcsICJvIiwgIlx1MDAxYlswbVx1MDAxYlsyN21cdTAwMWJbMjRtXHUwMDFiW0pcdTAwMWJbMzRtfi9mYXYvY2F0a2luX3dzXHUwMDFiWzM5bVxyXG5cclx1MDAxYlszNW3ina9cdTAwMWJbMzltIFx1MDAxYltLIl0KWzExLjE4NTMxNywgIm8iLCAiXHUwMDFiWz8xaFx1MDAxYj0iXQpbMTEuMTg1MzM4LCAibyIsICJcdTAwMWJbPzIwMDRoIl0KWzEyLjczODc0MiwgIm8iLCAiXHUwMDFiWz8yMDA0bFxyXHJcbiJdCg=="></asciinema-player><div class="admonition note">
<p class="admonition-title">Note</p>
<p>I added <code class="code docutils literal notranslate"><span class="pre">-n</span> <span class="pre">1</span></code> at the end of the command to echo only a single message. If you omit this argument, <code class="code docutils literal notranslate"><span class="pre">rostopic</span> <span class="pre">echo</span></code> will continue to print messages until you stop it with <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">C</kbd>.</p>
</div>
<p>These two commands are great to get at least some insights on what is going on during the execution of our node. But most of us will find it rather cumbersome to evaluate the echoed data in realtime. I mean, would you claim to be able to see that the echoed data is actually the output of a sine function? So some proper plotting tool might come in handy here.</p>
<p>We can use <code class="code docutils literal notranslate"><span class="pre">rqt_multiplot</span></code> to visualize the data. The following screenshot shows the thruster setpoints for the first two motors.</p>
<img alt="../_images/rqt_multiplot.png" src="../_images/rqt_multiplot.png" />
<p>General information to <code class="code docutils literal notranslate"><span class="pre">rqt_multiplot</span></code> can be found in the <a class="reference external" href="http://wiki.ros.org/rqt_multiplot">ROS Wiki</a> and some step-by-step instructions in the section <a class="reference internal" href="rqt_multiplot.html#rqt-multiplot"><span class="std std-ref">RQt Multiplot</span></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../00_main_toc/tutorials.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ros_launch_setup.html" class="btn btn-neutral float-right" title="ROS Launch Setup" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Thies Lennart Alff, Nathalie Bauschmann, Daniel Dücker.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: main
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="ros_package.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>